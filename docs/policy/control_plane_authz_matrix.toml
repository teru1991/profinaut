[meta]
id = "policy.control_plane_authz_matrix"
version = "1.0.0"
owner = "profinaut"
last_updated = "2026-02-25"

[changelog]
latest = "2026-02-25: initial RBAC matrix for control plane."

[roles]
# Canonical roles: view_only, operator, admin, break_glass
defined = ["view_only", "operator", "admin", "break_glass"]

[permissions]
# read-only
view_dashboard = ["view_only", "operator", "admin", "break_glass"]
view_reports = ["view_only", "operator", "admin", "break_glass"]

# operational safe actions
pause_bot = ["operator", "admin", "break_glass"]
stop_bot = ["operator", "admin", "break_glass"]
generate_support_bundle = ["operator", "admin", "break_glass"]

# dangerous ops (challenge/confirm required by core spec)
start_live = ["admin", "break_glass"]
relax_killswitch = ["admin", "break_glass"]
disable_gate = ["break_glass"]
unquarantine = ["admin", "break_glass"]
apply_live_config = ["admin", "break_glass"]

[break_glass]
# Must be time-bounded; exact window is policy.
max_duration_minutes = 30
require_reason = true
